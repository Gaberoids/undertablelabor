{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<!-- <link rel="stylesheet" href="{% static 'profiles/css/profile.css' %}"> -->
{% endblock %}

{% block page_header %}
<div class="container header-container">
    <div class="row">
        <div class="col">header</div>
    </div>
</div>
{% endblock %}

{% block content %}
    <h2 class="logo-font mb-4">Service Business Card Contact Page</h2>
    <p>AKA = {{ service.default_aka }}</p>
    <p>Service provider = {{ service.default_service_provider }}</p>
    <p>Town and City = {{ service.default_town_or_city }}</p>
    <p>County = {{ service.default_county }}</p>
    <p>Postcode = {{ service.default_postcode }}</p>
    <div style="border-bottom: 4px dotted blue;"></div>

    <!-- button -->
    <h3>Contact this service</h3>
    <p>Crispy Form section to send message</p>
    <form class="" action="{% url 'checkout' %}" method="POST" id="">
        {% csrf_token %}
        {{ form|crispy }}
        <button class="">Submit message and go to checkout page</button>
    </form>
    
    <!-- generate a row for each message in the history -->
 
        {% if request.user.is_authenticated %}
            <h3>MESSAGE HISTORY</h3>
                                   <div class="col-sm-12 mb-3">
                                       <div class="card h-100">
                                           <div class="card-body">
                                               <h6 class="d-flex align-items-center mb-3"><i
                                                       class="material-icons text-info mr-2"> Messages History</i>Project
                                                   Status</h6>
                                               {% if all_messages %}

                                               <table class="table table-hover">
                                                   <thead>
                                                       <tr>
                                                           <th scope="col">#</th>
                                                           <th scope="col">To:</th>
                                                           <th scope="col">Title</th>
                                                           <th scope="col">Created</th>
                                                           <th>Sent</th>
                                                       </tr>
                                                   </thead>
                                                   {% for message in all_messages %}

                                                   <tbody>
                                                       <tr>
                                                           <th scope="row">1</th>
                                                           <td>{{ message.m_sender }}</td>
                                                           <td>{{ message.m_title }}</td>
                                                           <td>{{ message.m_created_date }}</td>
                                                           {% if message.m_sent == true %}
                                                           <td>Yes</td>
                                                            {% else %}
                                                            <td>No</td>
                                                            {% endif %}
                                                        </tr>
                                                   </tbody>
                                                   {% endfor %}
                                               </table>
                                               {% else%}
                                               <p>You do not have stored drafts.</p>
                                               {% endif %}

                                           </div>
                                       </div>
                                   </div> \

        {% else %}
            <!--  DO NOT SHOW ANY MESSAGE HISTORY IF USER IS NOT LOGGED IN -->
        {% endif%}
    {% endblock %}

    {% block postloadjs %}
    {{ block.super }}
    <!-- <script type="text/javascript" src="{% static 'profiles/js/countryfield.js' %}"></script> -->
    {% endblock %}